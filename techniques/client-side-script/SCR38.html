<!DOCTYPE html>
<html lang="ja">
   <head>
      <meta charset="UTF-8" />
      <title>SCR38: プログレッシブエンハンスメントで設計されたウェブページに対して、適合している代替版を作成する</title>
      <link rel="stylesheet" type="text/css" href="https://www.w3.org/StyleSheets/TR/2016/base" />
      <link rel="stylesheet" type="text/css" href="../techniques.css" />
      <link rel="stylesheet" type="text/css" href="../slicenav.css" />
   </head>
   <body>
      <nav>
         <ul id="navigation">
            <li><a href="../#techniques" title="Table of Contents">Contents</a></li>
            <li><a href="../#introduction" title="Introduction to Techniques">Intro</a></li>
            <li><a href="SCR37">前の達成方法: SCR37</a></li>
            <li><a href="SCR39">次の達成方法: SCR39</a></li>
         </ul>
      </nav>
      <nav class="navtoc">
         <p>このページのコンテンツ:</p>
         <ul id="navbar">
            <li><a href="#important-information">達成方法に関する重要な情報</a></li>
            <li><a href="#applicability">達成方法に関する重要な情報</a></li>
            <li><a href="#description">解説</a></li>
            <li><a href="#examples">事例</a></li>
            <li><a href="#resources">参考リソース</a></li>
            <li><a href="#related">関連する達成方法</a></li>
            <li><a href="#tests">検証</a></li>
         </ul>
      </nav>
      <h1>プログレッシブエンハンスメントで設計されたウェブページに対して、適合している代替版を作成する</h1>
      <section id="important-information">
         <h2>達成方法に関する重要な情報</h2>
         <p>この達成方法 (参考) の使用法と、この達成方法が WCAG 2.1 達成基準 (規定) とどのように関係するのかに関する重要な情報については、<a href="https://waic.jp/docs/WCAG21/Understanding/understanding-techniques">WCAG 達成基準の達成方法を理解する</a>を参照のこと。適用 (対象) のセクションは、その達成方法の範囲について説明しており、特定の技術に関する達成方法の存在は、その技術があらゆる状況で WCAG 2.1 を満たすコンテンツを作成するために使用できることを意味するものではない。
         </p>
      </section>
      <main>
         <section id="applicability">
            <h2>適用 (対象)</h2>
            <p>HTML with scripting.</p>
            <p>この達成方法は、解説書から参照されていない。</p>
         </section>
         <section id="description">
            <h2>解説</h2>
            <p>この達成方法の目的は、プログレッシブエンハンスメントで設計されたウェブページに適合する代替バージョンを提供することである。この達成方法は、スクリプトを用いて達成する方法を次のように示している:
            </p>
            <ol>
               
               <li>ウェブページの初期拡張バージョンを格納することで、後に拡張されたコンテンツのバージョンに対して「適合した代替バージョン」として機能できるようにし、かつ
               </li>
               
               <li>すべての拡張されたバージョンのウェブページに対して、利用者がコンテンツを格納された初期拡張の代替バージョンに戻すことができる機能を実装する。
               </li>
               
            </ol>
            <p>プログレッシブエンハンスメントで設計されたウェブページはサポートされたウェブ技術を HTML 基盤のレイヤーに適用できるようにするため、ウェブ対応機器 (サイズ、機能及びソフトウェア) の特徴を検出する。より高度なアクセス機器のさまざまな機能に合わせて拡張バージョンのページが作成される一方で、そのようなウェブページの基本的なコンテンツと機能は、よりシンプルなウェブ対応機器を使用している人なら誰でも HTML 基盤を通じて利用することができる。
            </p>
            <p>現在の代替バージョンのウェブページの要件は次のようになっている: 「注記 4: 様々な技術環境又は利用者層に対応するために、複数の代替バージョンを提供してもよい。この場合、各バージョンは可能なかぎり適合したものでなければならず、適合要件 1 を満たすためには、そのうちの一つのバージョンが完全に適合したものでなければならない。」プログレッシブエンハンスメントで設計されたウェブページは、どのバージョンを完全に適合したものとして選ぶかという問題を残しているが、どんな利用者においても不利な状況におかれないようにする。
            </p>
            <p>この課題の解決策の一つは、広範囲のウェブ対応機器がコンテンツにアクセス可能なため、拡張前のウェブページ (例: スクリプト、スタイル、HTML ではないプラグインが無効時に作成される HTML のソースコードの DOM の状態) を「完全に適合したバージョン」として選択することである。
            </p>
            <div class="note">
               <div role="heading" class="note-title marker" aria-level="3">注記</div>
               <div>
                  <p>この達成方法はすべてのスクリプト、スタイル、プラグインを除外するが、これは WCAG 2.0 に適合するために必須ではないことを示す必要がある。制作者は類似した技術を使用することができるが、還元されたスタイルとスクリプトを「拡張前」のバージョンで保つことができる。
                  </p>
               </div>
            </div>
            <p>この技術は一つのバージョンで適合表明を行う方法を提供するが、コンテンツ制作者は各拡張版のウェブページが可能な限り適合するために作業し続けるべきである。
            </p>
         </section>
         <section id="examples">
            <h2>事例</h2>
            <section class="example" id="example-1-using-javascript">
               <h3>事例 1: JavaScript を使用する</h3>
               <p>この事例は「accToggle.js」ファイル内で JavaScript を使用し、HTML ソースコードのみで作成された拡張前のウェブページを格納することで、後に拡張されたウェブページの「適合した代替バージョン」として機能させることができる。そして、利用者がウェブページを最初の拡張前の「適合した代替バージョン」に戻せるよう、すべての拡張されたウェブページに切り替えリンクを設置する。注記: 「sayhello.js」ファイルは単なる外部のペイロードファイルの例であり、必要な他の外部スクリプトに置き換えられる。
               </p>
               <p>accToggle.js ファイル内のスクリプトは拡張前のバージョンを格納し、このバージョンの URL に #accessible という接尾辞を付与する。「WCAG 2.0 適合する代替版」という (すべての拡張されたバージョンのページにおいて、<code class="el">body</code> 要素の最初の子要素として設置される) リンクをクリックすることにより、接尾辞に「#accessible」とついた URL に変化し、<code class="el">body</code> 要素と <code class="el">head</code> 要素内の HTML を拡張前のコードに初期化する。拡張前の状態はリンクから、又は URL をブラウザに直接入力することでアクセスできる。さらに、拡張前の「適合する代替版」にリンクが追加され、利用者がウェブページを拡張版にすることができる (これはブラウザの戻るボタンからでも可能)。
               </p>
               <p>acctoggle.js ソースコード:</p><pre xml:space="preserve">window.onload = function(event) {

    // store pre-enhanced element content
    var initialHead = document.head.innerHTML;
    var initialBody = document.body.innerHTML;
    var initialURL = location.href;
    
    var runOnce = function() {
        // payload you want to run per page call - e.g. Google Analytics code
    }
    
    var setup = function() {
        // create conforming alternate version link

        var toggleEnhanced = document.querySelector("#toggle_enhanced");
        if (toggleEnhanced) {
            toggleEnhanced.outerHTML = "";
        }
        
        var nel = document.createElement("a");
        nel.id = "acctoggle";
        nel.setAttribute("href", "#accessible");
        nel.innerHTML = "WCAG 2.0 conforming alternate version";
        document.body.insertBefore(nel, document.body.firstChild);
        
        // payload
        var s = document.createElement("SCRIPT");
        s.setAttribute("src", "sayhello.js");
        document.querySelector("HEAD").appendChild(s);   
       }
    
    setup();
    runOnce();
    
    window.onpopstate = function(event) {
        if (location.href.indexOf("#accessible") != -1) {
            // revert element contents to pre-enhanced version
            document.head.innerHTML = initialHead;
            document.body.innerHTML = initialBody;
            
            // create enhanced version link
            var el = document.createElement("a");
            el.id = "toggle_enhanced";
            el.setAttribute("href", "");
            el.innerHTML = "Enhanced version";
            var back = function(e) {
                 e.preventDefault();
                 window.history.back();
            }
            el.addEventListener("click", back, false);
            document.body.insertBefore(el, document.body.firstChild);
        }
        if (location.href == initialURL) {
            setup();
        }
    };
}
		 </pre><p>HTML ウェブページソースコード:</p><pre xml:space="preserve">&lt;!DOCTYPE html&gt;
  &lt;html lang="en"&gt;
    &lt;head&gt;
        &lt;title&gt;Evaluera Ltd&lt;/title&gt;
        &lt;meta charset="UTF-8" /&gt;
        &lt;script src="accSwitch.js"&gt;&lt;/script&gt;
    &lt;/head&gt;
    &lt;body&gt; 
        &lt;h1&gt;Test Page&lt;/h1&gt;
        &lt;p&gt;Say: &lt;span id="change"&gt;Goodbye&lt;/span&gt;&lt;/p&gt;
    &lt;/body&gt;
&lt;/html&gt;			
		 </pre><p>sayhello.js ソースコード</p><pre xml:space="preserve">var change = document.querySelector("#change");
         change.innerText = "Hello";			
		 </pre></section>
            <section class="example" id="example-2-using-enhancejs---a-javascript-framework-designed-to-improve-the-application-of-progressive-enhancement">
               <h3>事例 2: EnhanceJS を使用する―プログレッシブエンハンスメントのアプリケーションを改善するために設計された Javascript フレームワーク
               </h3>
               <p>EnhanceJS は「高度なスタイルとスクリプトをページに適用する前に、JavaScript の主要な機能と CSS のサポートを最初にテストすることで、プログレッシブエンハンスメントのアプリケーションを改善するように設計された」オープンソースの JavaScript フレームワークである。さらに、デフォルトの <a href="https://code.google.com/p/enhancejs/">EnhanceJS</a> スクリプトは、利用者が拡張前のウェブページの状態に戻すことがでるよう、すべての拡張版のページに自動的に切り替えリンクを作成する。(EnhanceJS でデフォルトで設定されるこれを「低帯域幅版」と呼ぶ)。EnhanceJS ではこの設定は拡張前の状態が「低帯域幅版」ではなく、「WCAG 2.0 の適合している代替版」として認識されるよう変更されている。
               </p>
               <p>HTML コンポーネント:</p><pre xml:space="preserve">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
    &lt;head&gt;
    &lt;script type="text/javascript" src="enhance.js"&gt;&lt;/script&gt;
    &lt;script type="text/javascript"&gt;
        // Run capabilities test
        enhance({
            loadStyles: [
                "example.css"
            ], 
            loadScripts: [
                "example.js"
            ],
            // text shown in enhanced mode
            forceFailText: "WCAG 2.0 conforming alternate version",
            // text shown in accessible mode
            forcePassText: "Enhanced version"
        });
    &lt;/script&gt;
    &lt;/head&gt;
    ....

</pre></section>
         </section>
         <section id="resources">
            <h2>参考リソース</h2>
            <p>この参考リソースは、あくまでも情報提供のみが目的であり、推薦などを意味するものではない。</p>
            <ul>
               
               <li>
                  <a href="https://waic.jp/docs/WCAG-TECHS/C29.html#C29-sa1">クッキーを使用する</a></li>
               
               <li><a href="https://waic.jp/docs/WCAG-TECHS/C29.html#C29-sa2">プログレッシブエンハンスメントとアンオブトルーシブ JavaScript</a></li>
               
            </ul>
         </section>
         <section id="related">
            <h2>関連する達成方法</h2>
            <ul>
               
               <li><a href="https://waic.jp/docs/WCAG-TECHS/G136.html">G136: 不適合なウェブページの先頭に、適合している代替版を指すリンクを提供する</a></li>
               
               <li><a href="https://waic.jp/docs/WCAG-TECHS/C29.html">C29: 適合している代替版を提供するために、スタイルスイッチャーを使用する</a></li>
               
               <li><a href="https://waic.jp/docs/WCAG-TECHS/SVR4.html">SVR4: 適合している代替版の表示に関する設定を利用者が行えるようにする</a></li>
               
            </ul>
         </section>
         <section id="tests">
            <h2>検証</h2>
            <section class="procedure" id="procedure">
               <h3>手順</h3>
               
               <ol>
                  
                  <li>拡張されたウェブページが「適合している代替版」へのリンクを含んでいる。
                  </li>
                  
                  <li>代替版が、オリジナルページの<a href="https://waic.jp/docs/WCAG21/#dfn-conforming-alternate-version">適合している代替版</a>であり、かつ要求された適合レベルで WCAG 2.0 に適合していることを確認する。
                  </li>
                  
               </ol>
               
            </section>
            <section class="results" id="expected-results">
               <h3>期待される結果</h3>
               
               <ul>
                  
                  <li>1. 及び 2. の結果が真である。</li>
                  
               </ul>
               
            </section>
         </section>
      </main>
   </body>
</html>